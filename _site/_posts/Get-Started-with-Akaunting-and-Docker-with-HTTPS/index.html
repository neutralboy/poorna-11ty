<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" type="text/css" href="/index.css" />
    <title>Get started with Akaunting and Docker with HTTPS | Poorna's blog</title>
    <link
      rel="icon"
      type="image/png"
      href="https://res.cloudinary.com/poorna/image/upload/v1622972701/my-blog/logo/Screenshot_2021-06-06_at_15-14-35_Home_Poorna_s_Blog.png"
    />
    <meta name="description" content="Get started with akaunting and docker to manage your work and finances." />
    <meta property="og:description" content="Get started with akaunting and docker to manage your work and finances." />
    <meta property="og:title" content="Get started with Akaunting and Docker with HTTPS | Poorna's Blog " />
    <meta property="og:type" content="blog" />
    <meta property="og:url" content="https://www.poorna.dev/_posts/Get-Started-with-Akaunting-and-Docker-with-HTTPS/" />
    <meta
      property="og:image"
      content="https://res.cloudinary.com/poorna/image/upload/v1640502671/my-blog/poorna%20blog%20image.png"
    />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:alt" content="Poorna's blog logo" />
    <meta property="og:locale" content="en_US" />

    <meta property="og:article:published_time" content="Fri Jun 04 2021 00:20:19 GMT+0530 (India Standard Time)" />
    <meta property="og:article:tag" content="" />
    <meta property="og:article:author" content="Poornachandra" />
  </head>

  <body class="bg-slate-200 font-primary">
    <nav class="w-full top-0 sticky py-5 bg-indigo-900">
      <div class="lg:container mx-auto flex justify-between">
        <a
          href="/"
          class="text-3xl underline text-slate-200 font-bold block my-auto"
        >
          Poorna
        </a>
        <div class="flex gap-x-4">
          <a href="/say-hello" class="text-slate-200 text-lg block my-auto hover:underline hover:text-slate-100">
            Say Hello
          </a>
          <a
            rel="noopener"
            href="https://www.linkedin.com/in/poornachandra-v/"
            class="p-0.5 bg-blue-500 hover:bg-blue-600 lg:block hidden my-auto"
          >
            <svg
              class="fill-current text-white block"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M13 21H9V9H13V11C13.8526 9.91525 15.1456 9.26857 16.525 9.237C19.0056 9.25077 21.0072 11.2694 21 13.75V21H17V14.25C16.84 13.1326 15.8818 12.3036 14.753 12.306C14.2593 12.3216 13.7932 12.5378 13.4624 12.9046C13.1316 13.2715 12.9646 13.7573 13 14.25V21ZM7 21H3V9H7V21ZM5 7C3.89543 7 3 6.10457 3 5C3 3.89543 3.89543 3 5 3C6.10457 3 7 3.89543 7 5C7 5.53043 6.78929 6.03914 6.41421 6.41421C6.03914 6.78929 5.53043 7 5 7Z"
              ></path>
            </svg>
          </a>
        </div>
      </div>
    </nav>

    <div
      class="bg-indigo-800 py-10 mb-14 flex justify-center border-b-8 border-b-indigo-600"
    >
      <div class="lg:container mx-auto flex justify-between px-4">
        <h1 class="text-5xl font-bold text-slate-100 block my-auto">
          Get started with Akaunting and Docker with HTTPS
        </h1>
        <p
          class="block my-auto text-gray-600 bg-slate-200 px-2 py-1 rounded-md"
        >
          Medium
        </p>
      </div>
    </div>

    <div class="lg:container px-4 mx-auto">
      <div class="prose max-w-none mb-10"><blockquote>
<p><a href="https://akaunting.com/">Akaunting</a> is an open-source accounting software. They offer self hosted and managed platform to manage all your finances.</p>
</blockquote>
<p>Here's a preview of accounting:
<img src="https://res.cloudinary.com/poorna/image/upload/c_scale,q_auto,w_1300/v1622727459/my-blog/Screenshot_2021-06-03_at_19-05-03_Dashboard_-_Accel_Samurai.png" alt="Perview of Akaunting"></p>
<h3>Lets assume you have setup a machine with docker and docker-compose.</h3>
<p>Follow through on the commands below and your own self hosted finance at the end of it.
Though Akauntings docker docs are comprehensive, they dont have a documentation on making it secure</p>
<pre><code>git clone https://github.com/akaunting/docker
cd docker
cp env/db.env.example env/db.env
cp env/run.env.example env/run.env
</code></pre>
<h3>Now open the env/run.env file and set the parameters right.</h3>
<p>Here's how the file should look:</p>
<pre><code class="language-env"># You should change this to match your reverse proxy DNS name and protocol
APP_URL=https://&lt;your-domain.com&gt; # No need of a trailing slash
LOCALE=en-US

# Don't change this unless you rename your database container or use rootless podman, in case of using rootless podman you should set it to 127.0.0.1 (NOT localhost)
DB_HOST=akaunting-db

# Change these to match env/db.env
DB_DATABASE=akaunting
DB_USERNAME=admin
DB_PASSWORD=akaunting_password

# You should change this to a random string of three numbers or letters followed by an underscore
DB_PREFIX=asd_

# These define the first company to exist on this instance. They are only used during setup.
COMPANY_NAME=&lt;Your company name&gt;
COMPANY_EMAIL=&lt;Your company email&gt;

# This will be the first administrative user created on setup.
ADMIN_EMAIL=&lt;Admin email&gt;
ADMIN_PASSWORD=&lt;Admin password&gt;
</code></pre>
<p>Save and close the file.</p>
<h3>Make changes to docker-compose.yml</h3>
<p>Edit the existing <code>docker-compose.yml</code> to add the caddy service to it.</p>
<blockquote>
<p><a href="https://caddyserver.com/">Caddy</a> is a highly performant reverse proxy server written in GoLang. Caddy takes care of reverse proxy and adding a wild card certificate to the domain.</p>
</blockquote>
<pre><code class="language-yaml">version: '3.7'
services:
  akaunting:
    container_name: akaunting
    image: docker.io/akaunting/akaunting:latest
    build:
      context: .
    ports:
      - 8080:80
    volumes:
      - akaunting-data:/var/www/html/storage
      - akaunting-modules:/var/www/html/modules
    restart: unless-stopped
    env_file:
      - env/run.env
    environment:
      - AKAUNTING_SETUP
    depends_on:
      - akaunting-db
    networks:
      - app-network
    

  akaunting-db:
    container_name: akaunting-db
    image: mariadb
    volumes:
      - akaunting-db:/var/lib/mysql
    restart: unless-stopped
    env_file:
      - env/db.env
    networks:
      - app-network

  akaunting-update:
    image: containrrr/watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    command: --cleanup akaunting akaunting-db

  caddy:
    image: caddy:2.3.0-alpine
    container_name: caddy
    restart: unless-stopped
    ports:
      - &quot;80:80&quot;
      - &quot;443:443&quot;
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile
    networks:
      - app-network
    depends_on: 
      - akaunting

volumes:
  akaunting-data:
  akaunting-modules:
  akaunting-db:


networks:
    app-network:
      driver: bridge
</code></pre>
<h3>Add the Caddyfile in the same location as docker-compose.yml</h3>
<p>Create a file called Caddyfile (no file extension name!) and add the following into it.</p>
<blockquote>
<p>Caddyfile is how Caddy takes in configuration akin to the ngnix/sites-enabled files</p>
</blockquote>
<pre><code class="language-caddy">&lt;your-domain.com&gt; {
    encode gzip
    reverse_proxy akaunting:80
}
</code></pre>
<p>Save and exit the file.</p>
<h3>Start the setup</h3>
<p>Now execute the following commands:</p>
<pre><code>AKAUNTING_SETUP=true docker-compose up -d
</code></pre>
<p>In your browser open up &lt;your-domain.com&gt; and finish the Akaunting setup</p>
<blockquote>
<h4>Akaunting API key isnt necessary to complete the install, you can skip the step</h4>
</blockquote>
<h3>Once setup is completed</h3>
<p>Start the container again without the env variable that is required for setup.</p>
<pre><code class="language-bash">docker-compose down -v
docker-compose up -d
</code></pre>
<h3>Sweet Perk: Auto-updating your Akaunting installation</h3>
<p>Included in the docker-compose.yml file is a container called watchtower which takes care of the auto updating</p>
</div>
    </div>

    <a href="/" class="sticky bottom-0 text-xl bg-white px-3 py-2 rounded-r-md">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-6 h-6 inline"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"
        />
      </svg>
      Go back
    </a>
  </body>
</html>
